[
  {
    "objectID": "get_goals_for_picks.html",
    "href": "get_goals_for_picks.html",
    "title": "World Cup Blackjack",
    "section": "",
    "text": "Code\nimport pandas as pd\n\n\n\n\nCode\n# Pull the known results\ndf_fixtures = pd.read_csv(\"https://fixturedownload.com/download/fifa-world-cup-2022-UTC.csv\")\ndf_results = df_fixtures[df_fixtures[\"Result\"].notna()]\n\n\n\n\nCode\n# Split Result into home goals and away goals\ndf_results[\"Home Goals\"] = df_results[\"Result\"].apply(lambda x: int(x.split(\"-\")[0]))\ndf_results[\"Away Goals\"] = df_results[\"Result\"].apply(lambda x: int(x.split(\"-\")[1]))\n\n\n/tmp/ipykernel_22654/3602420346.py:2: SettingWithCopyWarning:\n\n\nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n\n/tmp/ipykernel_22654/3602420346.py:3: SettingWithCopyWarning:\n\n\nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n\n\n\n\n\nCode\n# Get the total goals for each team\ndf_goals = pd.concat(\n    [\n        df_results[[f\"{x} Team\", f\"{x} Goals\"]].rename(columns = lambda x: x.split(\" \")[1]) \n        for x in [\"Home\", \"Away\"]\n    ]\n)\ndf_goals = df_goals.groupby(\"Team\")[[\"Goals\"]].sum().reset_index()\n\n\n\n\nCode\n# Read the players picks\ndf_players_picks = pd.read_csv(\"df_players_picks.csv\")\n\n\n\n\nCode\n# Clean the players picks\ndf_players_picks = df_players_picks.set_index(\"name\")\ndf_players_picks[\"picks\"] = df_players_picks[\"picks\"].apply(lambda x: x.replace(\"[\", \"\").replace(\"]\", \"\").replace(\"'\", \"\"))\n\n\n\n\nCode\n# Convert the picks into seperate columns\ndf_players_goals = pd.DataFrame(df_players_picks[\"picks\"].str.split(\", \").tolist(), index=df_players_picks.index)\n\n\n\n\nCode\n# Convert to long\ndf_players_goals = df_players_goals.stack().to_frame(\"Team\")\ndf_players_goals.index = df_players_goals.index.droplevel(1)\n\n\n\n\nCode\n# Join the goals and aggregate to each player\ndf_players_goals = pd.merge(df_players_goals.reset_index(), df_goals, on=\"Team\", how=\"left\").fillna(0)\ndf_players_goals = df_players_goals.groupby(\"name\")[[\"Goals\"]].sum().astype(int)\n\n\n\n\nCode\n# Join the total goals the the original dataframe\ndf_players_picks_with_goals = df_players_picks.join(df_players_goals)\n\n\n\n\nCode\ndf_players_picks_with_goals\n\n\n\n\n\n\n  \n    \n      \n      picks\n      Goals\n    \n    \n      name\n      \n      \n    \n  \n  \n    \n      Adam Ivison\n      England, Iran, Uruguay\n      0\n    \n    \n      Dan Wilson\n      Croatia, Ecuador, Germany\n      2\n    \n    \n      Ryan Lowes\n      Denmark, Ghana, Mexico\n      0\n    \n    \n      Anthony Chapman\n      England, Mexico, Spain\n      0\n    \n    \n      Grant Willis\n      Denmark, Qatar, Saudi Arabia\n      0\n    \n    \n      Jack Maddison\n      Ecuador, Mexico, Serbia\n      2\n    \n    \n      Liam Robson\n      Ghana, Morocco, Senegal\n      0\n    \n    \n      Adam Lowes\n      Argentina, Cameroon, Serbia\n      0\n    \n    \n      Cal Craig\n      Morocco, Netherlands, Tunisia\n      0\n    \n    \n      Liam Smith\n      Netherlands, Serbia, Tunisia\n      0\n    \n    \n      Paul Smith\n      Cameroon, England, Portugal\n      0\n    \n    \n      Ricky Wells\n      Belgium, Spain, USA\n      0\n    \n    \n      Connor Sweeney\n      Morocco, Qatar, Senegal\n      0\n    \n    \n      Will Forrester\n      Denmark, Serbia, Switzerland\n      0\n    \n    \n      Liam Murtha\n      Cameroon, Mexico, Uruguay\n      0\n    \n    \n      Sean Jackson\n      Costa Rica, Portugal, Wales\n      0\n    \n    \n      Chris Royal\n      Croatia, Ghana, Iran\n      0\n    \n    \n      Lee Carrick\n      France, Netherlands, Portugal\n      0\n    \n    \n      Martin Young\n      Belgium, Canada, Senegal\n      0\n    \n    \n      Danielle Young\n      Canada, Senegal, Switzerland\n      0\n    \n    \n      Adam Carrick\n      Belgium, Costa Rica, Ecuador\n      2\n    \n    \n      Georgia Wilson\n      Australia, Belgium, Mexico\n      0\n    \n    \n      Claire Hodkinson\n      Belgium, England, Ghana\n      0\n    \n    \n      Lee Mayne\n      Ecuador, Germany, Netherlands\n      2\n    \n    \n      Helen Wilson\n      Costa Rica, Germany, Uruguay\n      0"
  }
]